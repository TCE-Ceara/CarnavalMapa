let CarnavalMapa=(()=>{let o=[],c,r,m,p,g,t,u,v,a,y,h,E="",i=(s,t)=>{r=document.getElementById("cidade_nulo_msg"),p=document.getElementById("selectbox_cidades");var e=document.querySelector(".active");e&&e.classList.remove("active"),document.querySelector("#"+s).classList.add("active");try{var a=o.find(e=>e.id===s);if(!a)throw"Não foi possivel carregar o dados do municipio selecionado, isso pode ocorrer por falta de dados cadastrados na tabela ";var{id:i,"MUNICÍPIO":l,"TIPOS DE DESPESAS":d}=a,n=(c=document.getElementById("cidade_nulo"),m=document.getElementById("cidade_dados"),g=document.getElementById("cidade_titulo"),u=document.getElementById("despesas_total"),v=document.getElementById("despesas_lista"),y=document.getElementById("receitas_total"),h=document.getElementById("receitas_lista"),E=document.getElementById("data_alteracao"),c.style.display="none",m.style.display="block",p.value=i,g.innerText=l,u.innerText=I(d,"Despesa").toLocaleString("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}),y.innerText=I(d,"Receita").toLocaleString("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}),B(d));E.innerText=0!==n.getTime()?n.toLocaleDateString():"...",v.innerHTML=S(d,"Despesa")||f("Lista de Despesas Vazia!"),h.innerHTML=S(d,"Receita")||f("Lista de Receitas Vazia!")}catch(e){p&&(p.value=s),c&&(c.style.display="block"),r&&(r.innerHTML=b(t,`O município <strong>não possui</strong> registros de despesas e receitas para o carnaval ${(new Date).getFullYear()}.`)),m&&(m.style.display="none"),g&&(g.innerText=""),console.warn(e)}},f=e=>`
      <div class="is-size-4 py-4 has-text-grey is-flex is-justify-content-center is-align-items-center is-flex-gap-3">
        <span class="material-icons"> format_list_numbered </span>${e}
      </div>
    `,b=(e=null,s=null,t=!1)=>t?`
      <div class="is-fullwidth is-size-3 is-size-5-mobile is-size-3-tablet is-noto is-flex is-align-items-center is-flex-gap-2 has-text-weight-semibold">
        <i class="fa fa-map-marker"></i>
        <span class="is-nowrap">Município</span>
      </div>
      <h2 class="subtitle">Aguardando sua seleção para exibir a lista</h2>
      ${l()}
    `:`
      <div class="is-fullwidth is-size-3 is-size-5-mobile is-size-3-tablet is-noto is-flex is-align-items-center is-flex-gap-2 has-text-weight-semibold">
        <i class="fa fa-map-marker"></i>
        <span class="is-nowrap">${e}</span>
      </div>
      <h2 class="subtitle">${s}</h2>
      ${l()}
    `,l=()=>`
    <article class="message is-white mt-4">
        <div class="message-header is-flex-gap-3">
          <span class="message-header-title has-skeleton is-half-width">.</span>
          <span class="message-header-value is-skeleton">.</span>
          <span class="icon material-icons is-skeleton"></span>
        </div>
        <div class="message-body has-background-white py-0">
          <div class="message-body-list message-body-list-skeleton">
            <div class="has-skeleton">.</div>
            <div class="skeleton-lines mt-3">
              <div></div>
            </div>
            <div class="skeleton-lines mt-3">
              <div></div>
            </div>
            <div class="skeleton-lines mt-3">
              <div class="is-half-width"></div>
            </div>
          </div>
          <div class="message-body-list message-body-list-skeleton">
            <div class="has-skeleton">.</div>
            <div class="skeleton-lines mt-3">
              <div></div>
            </div>
            <div class="skeleton-lines mt-3">
              <div></div>
            </div>
            <div class="skeleton-lines mt-3">
              <div class="is-half-width"></div>
            </div>
          </div>
          <div class="message-body-list message-body-list-skeleton">
            <div class="has-skeleton">.</div>
            <div class="skeleton-lines mt-3">
              <div></div>
            </div>
            <div class="skeleton-lines mt-3">
              <div></div>
            </div>
            <div class="skeleton-lines mt-3">
              <div class="is-half-width"></div>
            </div>
          </div>
        </div>
      </article>
      <article class="message is-white mt-4">
        <div class="message-header is-flex-gap-3">
          <span class="message-header-title has-skeleton is-half-width">.</span>
          <span class="message-header-value is-skeleton">.</span>
          <span class="icon material-icons is-skeleton"></span>
        </div>
      </article>
    `,I=(e,t=null)=>{if(e)return e.reduce((e,s)=>t&&s.tipo!==t?e:e+(parseFloat(s.VALOR.replace("R$","").replace(/\./g,"").replace(",","."))||0),0)},S=(e,i=null)=>{let s=[];if(0<e.length)return e.reduce((e,s,t,a)=>{if(!e.some(e=>e.tipo===s["TIPO DE DESPESA"])){if(i&&s.tipo!==i)return e;e.push({tipo:s["TIPO DE DESPESA"],despesas:a.filter(e=>e["TIPO DE DESPESA"]===s["TIPO DE DESPESA"])})}return e},[]).map(e=>{s.push(`
        <div class="message-body-list">
          <p class="message-body-title">${e.tipo}</p>
          <dl class="message-body-dl">
            ${e.despesas.map(e=>`
              <div class="message-body-dl-content grid is-gapless">
                <dt class="cell is-row-start-1 is-col-span-2">${e["DESCRIÇÃO"]}</dt>
                <dd class="cell is-row-start-2"><span class="message-body-dl-tag">${e["label informações"]}:</span> ${e["INFORMAÇÕES"]}</dd>
                <dd class="cell is-row-start-4 is-col-span-2"><span class="message-body-dl-tag">Modalidade de aquisição:</span> <a class="message-body-dl-link" href="${e.URL}" target="_blank">${e.MODALIDADE}</a></dd>
                <dd class="cell message-body-dl-value is-col-start-2 is-row-span-2 is-nowrap"><span>${e.VALOR}</span></dd>
              </div>
              `).join("")}
          </dl>
        </div>`)}),s.join("\n")},B=e=>e.reduce((e,s)=>{var t,a;return s.data_alteracao&&([s,t,a]=s.data_alteracao.split("/"),0!==(a=new Date(a,t-1,s)).getTime())&&e<a?a:e},new Date(0));return{init:async()=>{await(async()=>{o=[];try{return await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQhTCZIBpoefMd8CqmP5gcPSP0BBF1bVzOnXR5jxyRqxcGSa1LQLcb3WV9ZUMBW6hsyaLqrINokSbuX/pub?gid=0&single=true&output=csv").then(e=>{if(e.ok)return e.text().catch(e=>{throw"Não foi possivel converter os dados da tabela corretamente"});throw"Ocorreu erro de conexão"}).then(e=>{e=Papa.parse(e,{header:!0,transformHeader:!0,dynamicTyping:!0,skipFirstNLines:!0});if(0<e.errors.length)throw e.errors.join("\n");return o=(e=>{if(e.length>0)e=e.reduce((e,s,t,a)=>{if(!e.some(e=>e["id"]===s["id"]))e.push({id:s["id"],"MUNICÍPIO":s["MUNICÍPIO"],"TIPOS DE DESPESAS":a.filter(e=>e["id"]===s["id"])});return e},[]);return e})(e.data),e.data}).catch(e=>{throw e instanceof TypeError&&e.message.includes("Failed to fetch")?"É possivel que haja um problema de compartilhamento de dado ou erro no endereço de requisição":e})}catch(e){throw console.error(e),e}})(),o.forEach(e=>{e.id&&((e=document.getElementById(e.id)).style.fill="#1919C4",e.style.stroke="#000000",e.style.color="#FFFFFF")})},showTooltip:(e,s)=>{((s,e)=>{var t=o.find(e=>e.id===s.target.id);let a,i="";t&&(a=I(t["TIPOS DE DESPESAS"],"Despesa").toLocaleString("pt-BR",{style:"decimal",currency:"BRL",minimumFractionDigits:2,notation:"compact"}),i=I(t["TIPOS DE DESPESAS"],"Receita").toLocaleString("pt-BR",{style:"decimal",currency:"BRL",minimumFractionDigits:2,notation:"compact"}));var t=document.getElementById("stgTooltip"),l=document.getElementById("stgTooltip-content"),d=document.getElementById("stgTooltip-contratacoes"),n=document.getElementById("stgTooltip-receitas");l.innerHTML=e,d.innerHTML=a?`Contratações: <span class="has-text-weight-medium">${a}</span>`:"",n.innerHTML=i?`Receitas: <span class="has-text-weight-medium">${i}</span>`:"",t.style.display="block",t.style.left=s.pageX+10+"px",t.style.top=s.pageY+10+"px"})(e,s)},hideTooltip:()=>{document.getElementById("stgTooltip").style.display="none"},selectBoxChange:(e,s)=>{e=e,s=s,c=document.getElementById("cidade_nulo"),r=document.getElementById("cidade_nulo_msg"),m=document.getElementById("cidade_dados"),g=document.getElementById("cidade_titulo"),(t=document.getElementById("despesas")).classList.remove("is-opened"),(a=document.getElementById("receitas")).classList.remove("is-opened"),e?(c.style.display="none",m.style.display="block",i(e,s)):(c.style.display="block",r.innerHTML=b("","",!0),m.style.display="none",g.innerText="",document.querySelector(".active").classList.remove("active"))},setMapData:(e,s)=>{i(e,s)},toggleCollapsible:e=>{(e=>{e=document.getElementById(e);e.classList.contains("is-opened")?e.classList.remove("is-opened"):e.classList.add("is-opened")})(e)}}})();
